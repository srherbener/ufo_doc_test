
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Building UFO in OS X &#8212; Building UFO in OS X 1.0.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installing third party software on the Mac for building UFO" href="config_mac.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="config_mac.html" title="Installing third party software on the Mac for building UFO"
             accesskey="N">next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Building UFO in OS X 1.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="building-ufo-in-os-x">
<h1>Building UFO in OS X<a class="headerlink" href="#building-ufo-in-os-x" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="config_mac.html">Installing third party software on the Mac for building UFO</a></li>
<li class="toctree-l1"><a class="reference internal" href="config_ec_tools.html">Configuring the EC tools on the Mac for building UFO</a></li>
</ul>
</div>
<div class="section" id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<p>This document is meant to show the user how to prepare their OS X operating
system (iMac, MacBook, etc.) for compiling UFO on their system, and then how
to run the build of the UFO code.</p>
</div>
<div class="section" id="background">
<span id="index-0"></span><h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>The Unified Forward Operator (UFO) is the software that implements the “observation operators”
piece of the data assimilation cost function.</p>
<p>The data assimilation cost function is:</p>
<div class="math">
\[J(x_0) = \left\{\sum_{i=0}^{N} [H(x_i) - y_i]^T R^{-1} [H(x_i) -y_i]\right\} + (x_o - x_b)^T B^{-1} (x_o - X_b)\]</div>
<p>where the observation operatores (UFO) are defined by <span class="math">\(H(x)\)</span>.</p>
</div>
<div class="section" id="prepare-the-mac-with-third-party-software">
<span id="index-1"></span><h2>Prepare the Mac with third party software<a class="headerlink" href="#prepare-the-mac-with-third-party-software" title="Permalink to this headline">¶</a></h2>
<p>In preparation for building UFO, the Mac needs to be configured properly with
third party software and the EC build tools.
The tool of choice for installing third party software packages on the Mac
is <a class="reference external" href="https://brew.sh/">Homebrew</a>.
Homebrew will be used to install <a class="reference external" href="https://gcc.gnu.org/">GNU compilers</a>,
and the <a class="reference external" href="http://eigen.tuxfamily.org/">Eigen</a>
and <a class="reference external" href="http://www.boost.org/">Boost</a> libraries.</p>
<p>This is accomplished in two steps:</p>
<ol class="arabic simple">
<li><a class="reference internal" href="config_mac.html"><span class="doc">Install third party software on the Mac</span></a></li>
<li><a class="reference internal" href="config_ec_tools.html"><span class="doc">Build the EC tools and libraries</span></a>.</li>
</ol>
</div>
<div class="section" id="build-ufo-components">
<span id="index-2"></span><h2>Build UFO components<a class="headerlink" href="#build-ufo-components" title="Permalink to this headline">¶</a></h2>
<p>Upon completion of the Mac configuration, you should be in good shape to
build UFO.
UFO has three components:</p>
<ol class="arabic simple">
<li>CRTM (Community Radiation Transfer Model)</li>
<li>OOPS (Object Oriented Prgramming System)</li>
<li>IODA (Interface for Observational Data Assimilation)</li>
</ol>
<p>Each component can be built with the same sequence of commands with only
a variation on the Git branch that is used.
The sequence for CRTM will be shown, and the branches for all three
components will be noted.</p>
<p>To build CRTM:</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span>cd $HOME/projects
git clone https://github.com/UCAR/crtm.git
git checkout master
cd crtm
mkdir build
cd build
ecbuild $HOME/projects/crtm    # check ecbuild.log for errors/warnings
make -j4
ctest
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There is no “make install” step necessary for this process.
This is so because UFO only needs the libraries created by building
CRTM, OOPS, and IODA.
When building UFO, the ecbuild command will be told where to look
for the component libraries (see below).</p>
</div>
<p>Repeat the above command sequence to build OOPS (substitute the string
“oops” for “crtm”) and IODA (substitute the string “ioda” for “crtm”).
Make sure that the proper Git branch is used for each component and noted
below.</p>
<div class="topic">
<p class="topic-title first">Git branches for UFO components</p>
<p>For OOPS: git checkout feature/ufo</p>
<p>For IODA: git checkout develop</p>
</div>
</div>
<div class="section" id="build-ufo">
<span id="index-3"></span><h2>Build UFO<a class="headerlink" href="#build-ufo" title="Permalink to this headline">¶</a></h2>
<p>Once CRTM, OOPS and IODA are successfully built (tests pass) UFO can
then be compiled.
This is accomplished with a similar command sequence to that
which was used for the components.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span>cd $HOME/projects
git clone https://github.com/UCAR/ufo.git
git checkout develop
cd ufo
mkdir build
cd build
ecbuild -Dcrtm_SOURCE_DIR=$HOME/projects/crtm -DIODA_PATH=$HOME/projects/ioda/build -DCRTM_PATH=$HOME/projects/crtm/build -DOOPS_PATH=$HOME/projects/oops/build ~/projects/ufo
make -j4
ctest
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The long string of -D options on the ecbuild command are there to tell
the UFO build process where the libraries for CRTM, OOPS and IODA are
located (the “build” directories for each component).
An additional option, -Dcrtm_SOURCE_DIR, is needed to tell the UFO build
process where test data from CRTM is located.</p>
</div>
</div>
<div class="section" id="jedi-bundle">
<span id="index-4"></span><h2>jedi-bundle<a class="headerlink" href="#jedi-bundle" title="Permalink to this headline">¶</a></h2>
<p>You may have noticed some awkwardness in the UFO build process.
Specifically, the need to remember the proper Git branches for the
checkout commands, and the need to specify the locations of the
component build directories greatly increase the possibility of
making mistakes along the way.
While it is instructive to go through the above process, a separate
UCAR GitHub repository (called “jedi-bundle”) has been created
to mitigate the opportunity for errors during the build process.
Jedi-bundle takes care of checking out the proper git branches, building
all of the components (along with UFO) and passing on the locations
of the components to the UFO build process.
Jedi-bundle can be downloaded and built by running the following:</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span>cd $HOME/projects
git clone https://github.com/UCAR/jedi-bundle.git
cd jedi-bundle
mkdir build
cd build
ecbuild $HOME/projects/jedi-bundle
make -j4
ctest
</pre></div>
</div>
<p>Much easier!</p>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Next topic</h4>
  <p class="topless"><a href="config_mac.html"
                        title="next chapter">Installing third party software on the Mac for building UFO</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="config_mac.html" title="Installing third party software on the Mac for building UFO"
             >next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Building UFO in OS X 1.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Stephen Herbener.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>